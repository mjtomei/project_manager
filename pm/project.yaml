project:
  name: project-manager
  repo: https://github.com/mjtomei/project_manager.git
  base_branch: master
  backend: github
  active_pr: pr-3563708
  guide_deps_reviewed: true
  repo_id: 828c8d0a91034cd541f443dd0aee62961e2af75a
  last_pr_sync: '2026-02-19T23:48:36.288796+00:00'
plans:
- id: plan-001
  name: Import from existing repo
  file: plans/plan-001.md
  status: draft
- id: plan-002
  name: Multi-candidate test-driven code generation
  file: plans/plan-002.md
  status: draft
- id: plan-003
  name: Multiuser Support
  file: plans/plan-003.md
  status: draft
- id: plan-e4fa5cb
  name: refactor for code quality
  file: plans/plan-e4fa5cb.md
  status: done
prs:
- id: pr-001
  plan: plan-001
  title: Add background cluster computation to plan import
  branch: pm/pr-001-add-background-cluster-computation-to-plan-import
  status: pending
  depends_on: []
  description: Run cluster extraction in parallel when `_run_plan_import` starts,
    so results are available without blocking the interactive flow
  agent_machine: null
  gh_pr: null
- id: pr-002
  plan: plan-001
  title: Include cluster suggestions in import prompt
  branch: pm/pr-002-include-cluster-suggestions-in-import-prompt
  status: pending
  depends_on:
  - pr-001
  description: Add cluster analysis results as a "Phase 1.5" in the import prompt
    - Claude receives clusters as a suggested starting point for PR decomposition,
    which can be used, modified, or ignored
  agent_machine: null
  gh_pr: null
- id: pr-003
  plan: plan-001
  title: Add cluster-first option to guide workflow
  branch: pm/pr-003-add-cluster-first-option-to-guide-workflow
  status: pending
  depends_on: []
  description: In the guide's "initialized" step, offer `pm cluster explore` as an
    alternative path alongside `pm plan add`, giving users a choice between manual
    and automated starting points
  agent_machine: null
  gh_pr: null
- id: pr-004
  plan: plan-001
  title: Smart repo-size detection with approach recommendation
  branch: pm/pr-004-smart-repo-size-detection-with-approach-recommenda
  status: pending
  depends_on:
  - pr-003
  description: Detect repo size (lines of code) and recommend manual vs cluster-based
    approach automatically - small repos get manual suggestion, large repos get cluster
    suggestion
  agent_machine: null
  gh_pr: null
- id: pr-005
  plan: plan-001
  title: Improve git remote detection in pm init
  branch: pm/pr-005-improve-git-remote-detection-in-pm-init
  status: merged
  depends_on: []
  description: pm init hardcodes 'origin' remote, but repos may have multiple remotes
    or use different naming (e.g., 'github', 'upstream'). Should detect the correct
    remote by checking if it exists/works, letting user choose when ambiguous, or
    preferring remotes matching the detected backend.
  agent_machine: spark-424d
  gh_pr: null
  workdir: null
- id: pr-006
  plan: plan-001
  title: Add automatic PR sync on TUI refresh and periodic background check
  branch: pm/pr-006-add-automatic-pr-sync-on-tui-refresh-and-periodic-
  status: merged
  depends_on: []
  description: 'Currently pm pr sync must be run manually. Add: (1) automatic sync
    when TUI refreshes (r key), (2) periodic background sync every 5 minutes in TUI,
    (3) sync before pr-related commands. Store last sync timestamp to avoid excessive
    API calls.'
  agent_machine: spark-424d
  gh_pr: null
  workdir: null
- id: pr-007
  plan: plan-001
  title: 'GitHub backend: Create draft PR at start, upgrade on done'
  branch: pm/pr-007-github-backend-create-draft-pr-at-start-upgrade-on
  status: merged
  depends_on: []
  description: 'Change GitHub backend flow: (1) pm pr start creates a draft PR immediately
    after first push, stores gh_pr number in project.yaml, (2) pm pr done upgrades
    draft to ready-for-review using ''gh pr ready'', (3) status becomes in_review
    only after upgrading. This gives visibility into WIP earlier and uses GitHub''s
    native draft PR workflow.'
  agent_machine: spark-424d
  gh_pr: null
  workdir: null
- id: pr-009
  plan: plan-001
  title: Auto-rebalance after pane launch
  branch: pm/pr-009-auto-rebalance-after-pane-launch
  status: merged
  depends_on: []
  description: After launching a new pane, the layout should automatically rebalance.
    Currently requires manual 'b' keypress to rebalance.
  agent_machine: spark-424d
  gh_pr: null
  workdir: null
- id: pr-010
  plan: plan-001
  title: Isolate workdir pm state from main repo
  branch: pm/pr-010-isolate-workdir-pm-state-from-main-repo
  status: merged
  depends_on: []
  description: 'Agents in workdirs can modify pm/project.yaml and push to GitHub,
    which then gets synced to the main TUI causing unexpected state changes (test
    PRs appearing, status changes, etc.).


    Fix options:

    1. Workdirs should not include pm/ directory at all - agents work on code only

    2. Or workdirs get a read-only copy of pm/ that isn''t pushed

    3. Or agents are instructed not to modify pm state except their own PR status

    4. Or git_ops.sync_state() should only pull pm/ changes from master, not from
    PR branches


    Recommended: Option 1 - exclude pm/ from workdir clones since agents only need
    the code, not the project management state.'
  agent_machine: spark-424d
  gh_pr: null
  workdir: null
- id: pr-011
  title: Fix plans pane w key launching wrong action
  branch: null
  status: merged
  depends_on: []
  description: 'In the plans pane, pressing w (breakdown) sometimes launches pm plan
    review instead of pm plan breakdown. The PlanAction("breakdown") message is posted
    correctly by plans_pane.py, but the app handler routes it to the wrong command.


    Reproduction steps:

    1. Open the TUI and press P to enter plans view

    2. Select a plan (e.g. plan-001)

    3. Press w to trigger breakdown

    4. Check pane registry: the new pane has role "plan-review" running "pm plan review
    plan-001" instead of role "plan-breakdown" running "pm plan breakdown plan-001"

    5. Also observed: first w press sometimes produces no pane at all (no log entry
    for "plan action: breakdown"), while a second w press creates the wrong pane type


    The mismatch may indicate the on_plan_action handler is receiving a different
    action string than expected, or there is a code path where the running TUI code
    diverges from the source on disk.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/32
  gh_pr_number: 32
  workdir: null
- id: pr-012
  plan: plan-002
  title: Local model runner with OpenAI-compatible API
  branch: pm/pr-012-local-model-runner-with-openai-compatible-api
  status: closed
  depends_on: []
  description: 'Create a module that manages local LLM inference via the OpenAI-compatible
    API exposed by local serving backends (see `pm/plans/plan-002.md` for the broader
    multi-candidate generation strategy). Support three backends with automatic platform
    detection: llama.cpp server on macOS, sglang and vllm on Linux. All three expose
    the same OpenAI-compatible chat/completions endpoint, so the core runner uses
    a single HTTP client with backend-specific server management (health checks, model
    listing). Server URL is configured via `PM_BENCH_URL` environment variable with
    a sensible default per backend (e.g. `http://localhost:8080` for llama.cpp, `http://localhost:30000`
    for sglang). Support sending prompts to a configurable model, collecting responses,
    and running multiple generations with different temperatures in parallel. Track
    token counts and wall-clock time per request for downstream cost analysis. Include
    a CLI command (`pm bench models`) that detects the available backend, lists loaded
    models, and validates connectivity.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/33
  gh_pr_number: 33
  workdir: null
- id: pr-013
  plan: plan-002
  title: Aider polyglot exercise loader
  branch: pm/pr-013-aider-polyglot-exercise-loader
  status: closed
  depends_on: []
  description: 'Load the Exercism exercises used by aider''s polyglot benchmark (https://github.com/Aider-AI/aider
    — see `benchmark/` directory for exercise structure). Each exercise has a problem
    description, starter code, and a reference test suite. Parse exercises into a
    structured format: {language, slug, description, starter_code, reference_tests}.
    Support filtering by language and exercise name. Clone or download the exercise
    set from aider''s benchmark repo and cache it locally under `~/.cache/pm-bench/exercises/`.
    Include a CLI command (`pm bench exercises`) that downloads/updates the exercise
    cache and lists available exercises with optional `--language` filter.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/34
  gh_pr_number: 34
  workdir: null
- id: pr-014
  plan: plan-002
  title: Test generation from problem descriptions
  branch: pm/pr-014-test-generation-from-problem-descriptions
  status: closed
  depends_on: []
  description: 'Given an exercise''s problem description and starter code (but NOT
    the reference tests), generate test cases using a local model. The core insight
    from the plan (`pm/plans/plan-002.md`): verification is easier than generation
    — a model that scores poorly on single-pass coding can generate useful tests that
    filter better solutions from multiple candidates. Use the problem description
    and function signatures to produce tests that verify correctness. Generate tests
    at multiple temperatures and with prompt variations to increase diversity. Deduplicate
    and validate generated tests (must parse, must be syntactically valid, must reference
    the correct function names). Return a merged test suite as a single source file
    string per language''s test convention.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/35
  gh_pr_number: 35
  workdir: null
- id: pr-015
  plan: plan-002
  title: Multi-candidate solution generation
  branch: pm/pr-015-multi-candidate-solution-generation
  status: closed
  depends_on: []
  description: Given an exercise's starter code, problem description, and a test suite
    (either generated or reference), produce N candidate solutions using a local model.
    Vary temperature (0.0 to 1.0) and prompt format (direct, chain-of-thought, example-driven).
    Multi-model support (querying different models on the same backend) is a stretch
    goal — the initial implementation should work well with a single model and temperature/prompt
    diversity. Each candidate is a complete file that should compile and pass the
    tests. Return candidates as a list of {code, temperature, prompt_variant, model}.
    See `pm/plans/plan-002.md` for how candidate diversity feeds into tournament selection.
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/36
  gh_pr_number: 36
  workdir: null
- id: pr-016
  plan: plan-002
  title: Test execution and candidate scoring
  branch: pm/pr-016-test-execution-and-candidate-scoring
  status: closed
  depends_on:
  - pr-013
  description: 'Run a test suite against a candidate solution in an isolated environment.
    Use temporary directories with copies of the exercise scaffold — each candidate
    gets its own temp directory, solution file is written in, and the language-appropriate
    test runner is invoked via subprocess with a timeout. Support the 6 polyglot languages
    with appropriate build/test commands: `pytest` for Python, `go test` for Go, `cargo
    test` for Rust, `npm test` / `jest` for JavaScript, `javac` + `junit` for Java,
    `cmake` + `ctest` or `g++` + run for C++. Return per-test pass/fail results and
    an overall score. Score candidates as (passing_tests / total_tests). Handle compilation
    failures, timeouts, and runtime errors gracefully.'
  agent_machine: null
  gh_pr: null
  gh_pr_number: null
- id: pr-017
  plan: plan-002
  title: 'Benchmark: multi-candidate code generation with tournament selection'
  branch: pm/pr-017-benchmark-orchestrator-with-tournament-selection-v2
  status: in_review
  depends_on: []
  description: 'Collapsed implementation of the full benchmark pipeline from plan-002.
    Includes: OpenAI-compatible multi-backend runner (llama.cpp/sglang/vllm), Exercism
    exercise loader from aider''s polyglot-benchmark, test generation from problem
    descriptions, multi-candidate solution generation, test execution with 6-language
    support, and tournament orchestrator with baseline comparison, cost metrics, and
    JSON export. CLI commands: pm bench models, pm bench exercises, pm bench run.
    Supersedes pr-012 through pr-016.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/69
  gh_pr_number: 69
  workdir: null
- id: pr-018
  plan: plan-002
  title: Baseline measurement and analysis
  branch: pm/pr-018-baseline-measurement-and-analysis
  status: pending
  depends_on:
  - pr-017
  description: 'Add a CLI command `pm bench analyze` that reads benchmark result JSON
    files produced by the orchestrator and generates comparison reports. Run the benchmark
    via `pm bench run` in single-pass mode (N=1, no test generation) to establish
    the baseline, then with tournament (N=8, N=16) and compare. Produce a report showing:
    baseline vs tournament scores per language, per exercise difficulty tier (easy/medium/hard,
    based on baseline pass rate — easy: >66% of models solve it, hard: <33%), and
    aggregate. Include cost analysis — total tokens generated, wall-clock time, and
    tokens-per-correct-exercise for each configuration, so the accuracy improvement
    can be weighed against the compute cost (e.g., "N=16 tournament scores 58% vs
    40% baseline but costs 20x the tokens"). Identify which exercises benefit most
    from multi-candidate generation (large delta) vs which are insensitive (model
    either always gets it or never does). Save analysis results to a JSON file for
    tracking over time.'
  agent_machine: null
  gh_pr: null
  gh_pr_number: null
- id: pr-019
  plan: plan-002
  title: Generated test quality analysis
  branch: pm/pr-019-generated-test-quality-analysis
  status: pending
  depends_on:
  - pr-017
  description: 'Add a CLI command `pm bench test-quality` that analyzes how well generated
    tests compare to reference tests. This is critical for validating the plan''s
    core assumption (`pm/plans/plan-002.md`) that verification is easier than generation
    — if generated tests are poor, tournament selection breaks down regardless of
    candidate quality. Reads benchmark result JSON from the orchestrator, which includes
    both generated and reference test outcomes per candidate. Measure: (1) coverage
    overlap — run each candidate against both generated and reference tests and compute
    rank correlation (do generated tests rank candidates in the same order as reference
    tests?), (2) false positives — identify generated tests that pass on candidates
    that fail all reference tests (using the failed candidates already present in
    benchmark results), (3) diversity — count distinct pass/fail signatures across
    generated tests (more signatures = more behavioral coverage). Cross-reference
    with benchmark results: do exercises where generated tests diverge most from reference
    tests also show the largest gap between tournament-selected and oracle-selected
    (best candidate scored against reference tests) scores?'
  agent_machine: null
  gh_pr: null
  gh_pr_number: null
- id: pr-020
  plan: null
  title: Fix TUI command deduplication for concurrent PR actions
  branch: pm/pr-020-fix-tui-command-deduplication-for-concurrent-pr-ac
  status: merged
  depends_on: []
  description: 'The TUI allows the same action (e.g. pr start) to be triggered multiple
    times before the first invocation completes, and allows the same action on multiple
    PRs simultaneously, causing race conditions and buggy behavior. Add guards to
    prevent: (1) re-triggering an action while it is still running, (2) running conflicting
    actions on different PRs concurrently (e.g. two pr starts). Track in-flight actions
    and either queue or reject duplicates, showing a status message to the user.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/38
  gh_pr_number: 38
  workdir: null
- id: pr-021
  plan: null
  title: Fix tmux commands to target current grouped session instead of base
  branch: pm/pr-021-fix-tmux-commands-to-target-current-grouped-sessio
  status: merged
  depends_on: []
  description: Commands that switch windows or interact with the tmux session (e.g.
    automatic window switching) target the base session name instead of the current
    grouped session. Need a helper that detects the current grouped session and targets
    that, falling back to the base session when not inside tmux.
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/39
  gh_pr_number: 39
  workdir: null
- id: pr-022
  plan: plan-003
  title: Handle merging pm directory changes across clones
  branch: pm/pr-022-handle-merging-pm-directory-changes-across-clones
  status: merged
  depends_on: []
  description: When PRs are added in two separate clones/workdirs, the pm/project.yaml
    can diverge. Need a strategy for merging pm directory changes (e.g. new PRs added
    concurrently) — could be a git pull/merge of the pm directory, a TUI key to sync,
    or automatic conflict resolution.
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/40
  gh_pr_number: 40
  workdir: null
- id: pr-023
  plan: null
  title: Fix rebalance layout for grouped sessions with different terminal sizes
  branch: pm/pr-023-fix-rebalance-layout-for-grouped-sessions-with-dif
  status: merged
  depends_on: []
  description: When multiple terminals are attached via grouped sessions with different
    aspect ratios (e.g. portrait vs landscape), rebalance computes layout based on
    the shared window size (minimum of all clients) rather than the calling terminal's
    size. This means a portrait monitor doesn't get a horizontal split layout. Need
    to investigate tmux aggressive-resize or alternative approaches.
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/41
  gh_pr_number: 41
  workdir: null
- id: pr-024
  plan: plan-003
  title: Add multi-user support to sessions
  branch: pm/pr-024-add-multi-user-support-to-sessions
  status: merged
  depends_on: []
  description: Add support for two users on the same computer accessing the same pm
    session simultaneously. This is done by creating a tmux session with a session
    file that is accessible to a given group or all users on the system optionally.
    The choice between groups or global accessibility is controlled by a session command
    flag. The default continues to be accessibility only to the current user. Other
    users can access the same session by passing the same flags as well as the directory
    in which the original user started the session. The code uses that directory to
    correctly identify what the session tag is.
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/52
  gh_pr_number: 52
  workdir: null
- id: pr-142f20c
  plan: plan-e4fa5cb
  title: Convert cli.py to cli/ package and extract shared helpers
  branch: pm/pr-142f20c-convert-cli-py-to-cli-package-and-extract-shared-h
  status: merged
  depends_on: []
  description: Convert the monolithic pm_core/cli.py (4,427 lines) into a pm_core/cli/
    subpackage. Create cli/__init__.py with the `cli` Click group, `main` entry point,
    and the core commands (init, push, set, help, getting-started, which, prompt)
    — these stay in __init__.py. Move HelpGroup, load_and_sync, save_and_push, trigger_tui_refresh,
    _pr_id_sort_key, _pr_display_id, _resolve_pr_id, _infer_pr_id, _workdirs_dir,
    _resolve_repo_id, and state_root into cli/helpers.py. The __init__.py re-exports
    `cli` and `main` at module level so that `from pm_core.cli import cli` and `from
    pm_core.cli import main` continue to work (used by tests, __main__.py, and wrapper.py).
    This is the foundation for the next PR which splits all command groups into submodules.
    See `pm/plans/plan-e4fa5cb.md` for the overall split strategy and target line
    counts.
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/57
  gh_pr_number: 57
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-142f20c-convert-cli-py-to-cli-package-and-ex-b41f9a32
- id: pr-35b18e8
  plan: plan-e4fa5cb
  title: Split all CLI command groups into cli/ submodules
  branch: pm/pr-35b18e8-split-all-cli-command-groups-into-cli-submodules
  status: merged
  depends_on:
  - pr-142f20c
  description: 'Complete the cli/ package split by moving all remaining command groups
    out of cli/__init__.py into dedicated submodules. Each submodule imports `cli`
    from `pm_core.cli` and registers its commands; the __init__.py imports all submodules
    at the bottom to trigger registration. Submodules to create: (1) cli/pr.py (~940
    lines) — `pr` group: add, edit, select, cd, list, graph, ready, start, done, sync,
    sync-github, import-github, cleanup, close, plus `_launch_review_window` helper
    for code review pane. (2) cli/plan.py (~775 lines) — `plan` group: add, list,
    breakdown, review, deps, load, fixes, fix, import, plus _run_plan_import and _import_github_prs.
    (3) cli/session.py (~560 lines) — `session` group, `_register_tmux_bindings`,
    `_session_start`, internal pane/window commands (`_pane-exited`, `_pane-closed`,
    `_pane-opened`, `_window-resized`, `_pane-switch`, `rebalance`), session registry
    commands (`_save-session`, `_clear-session`). Note: pane-exited now passes pane_id
    and window for multi-window registry support. (4) cli/tui.py (~570 lines) — `tui`
    group: view, history, send, keys, clear-history, capture, frames, clear-frames,
    test, plus frame/history helpers and internal _tui launcher. (5) cli/guide.py
    (~300 lines) — guide group, _run_guide, notes command. (6) cli/meta.py (~335 lines)
    — meta command, _detect_pm_install, _build_meta_prompt, _meta_workdir. (7) cli/cluster.py
    (~220 lines) — cluster group: auto, explore. All submodules import shared helpers
    from `pm_core.cli.helpers`. After this PR, cli/__init__.py is trimmed to ~530
    lines (init, push, set, help, getting-started, which, prompt, plus submodule imports).
    See `pm/plans/plan-e4fa5cb.md` for the full cli/ split strategy table.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/62
  gh_pr_number: 62
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-35b18e8-split-all-cli-command-groups-into-cl-e742c9f2
- id: pr-f24211b
  plan: plan-e4fa5cb
  title: Split app.py into screens, widgets, and pane_ops
  branch: pm/pr-f24211b-split-app-py-into-screens-widgets-and-pane-ops
  status: merged
  depends_on: []
  description: 'Reduce tui/app.py from 2,230 lines to ~950 by extracting four categories
    of code into new modules: (1) tui/screens.py (~500 lines) — move WelcomeScreen,
    ConnectScreen, HelpScreen, PlanPickerScreen, PlanAddScreen. (2) tui/widgets.py
    (~100 lines) — move TreeScroll, StatusBar, LogLine. (3) tui/pane_ops.py (~560
    lines) — extract pane launch (`_launch_pane` with `fresh` param for pane recreation),
    kill, rebalance, zoom logic, and `_heal_registry` (multi-window registry repair)
    from ProjectManagerApp into standalone functions. (4) tui/_shell.py (~60 lines)
    — extract `_run_shell` and `_run_shell_async` helpers. The app delegates to pane_ops
    functions, passing the app instance or necessary state as parameters. After this
    PR, app.py contains ProjectManagerApp core lifecycle, event handling, z-modifier
    key handling (`_consume_z`), and sticky log messages. See `pm/plans/plan-e4fa5cb.md`
    for the tui/app.py split strategy.


    Tests: Run `pytest tests/` — all existing tests pass unchanged (including tests/test_shared_sessions.py
    which tests ConnectScreen, and tests/test_plans_pane.py which tests PlansPane
    and imports ProjectManagerApp). Add import smoke tests in a new tests/test_tui_imports.py
    that verify: (1) all screen classes can be imported from tui.screens, (2) all
    widget classes can be imported from tui.widgets, (3) pane_ops functions can be
    imported and have the expected signatures, (4) _shell helpers can be imported,
    (5) app.py re-exports or correctly imports from the new modules so existing `from
    pm_core.tui.app import ProjectManagerApp` still works.


    Files: pm_core/tui/app.py (modify — remove screen/widget/pane classes and methods,
    add imports), pm_core/tui/screens.py (create — ~500 lines), pm_core/tui/widgets.py
    (create — ~100 lines), pm_core/tui/pane_ops.py (create — ~560 lines), pm_core/tui/_shell.py
    (create — ~60 lines), tests/test_tui_imports.py (create — import smoke tests)'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/61
  gh_pr_number: 61
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-f24211b-split-app-py-into-screens-widgets-an-b41f9a32
- id: pr-0662fce
  plan: plan-e4fa5cb
  title: Extract tree layout and abstract TUI message factory
  branch: pm/pr-0662fce-extract-tree-layout-and-abstract-tui-message-facto
  status: merged
  depends_on: []
  description: 'Two related changes to tui/ code, combined because both modify tech_tree.py:
    (1) Move the tree layout algorithm (node positioning, column assignment, edge
    routing) from tech_tree.py into a new tui/tree_layout.py (~330 lines). TechTree
    widget calls layout functions and retains rendering + keyboard handling. Reduces
    tech_tree.py from 834 to ~500 lines. (2) Create a generic message factory function
    `item_message(name, field)` in tui/__init__.py that generates Selected/Activated
    message class pairs with a single ID field. Replace the boilerplate PlanSelected/PlanActivated
    in plans_pane.py, TestSelected/TestActivated in tests_pane.py, and PRSelected/PRActivated
    in tech_tree.py with factory-generated classes. See `pm/plans/plan-e4fa5cb.md`
    for the tech_tree.py split strategy and message factory design.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/56
  gh_pr_number: 56
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-0662fce-extract-tree-layout-and-abstract-tui-b41f9a32
- id: pr-7671dc7
  plan: plan-e4fa5cb
  title: Extract pane registry I/O from pane_layout.py
  branch: pm/pr-7671dc7-extract-pane-registry-i-o-from-pane-layout-py
  status: merged
  depends_on: []
  description: 'Move registry CRUD and lookup functions from pane_layout.py (now 614
    lines after multi-window registry refactor) into a new pane_registry.py. Functions
    to move: `registry_dir`, `registry_path`, `load_registry` (includes old→new format
    migration), `save_registry`, `register_pane` (per-window), `unregister_pane` (searches
    all windows), `kill_and_unregister`, `find_live_pane_by_role` (with optional `window`
    scoping), `_get_window_data`, `_iter_all_panes`, `_reconcile_registry` (per-window
    dead pane cleanup). pane_layout.py keeps the layout algorithm (`_layout_node`,
    `compute_layout`, `_checksum`), `rebalance`, mobile detection, and lifecycle event
    handlers (`handle_pane_exited`, `handle_any_pane_closed`, `handle_pane_opened`,
    `check_user_modified`) which orchestrate both registry and layout operations.
    The lifecycle handlers import from pane_registry. Update all callers across the
    codebase (cli/__init__.py or cli/session.py, tui/app.py or tui/pane_ops.py — whichever
    exists at the time) to import from pane_registry instead. See `pm/plans/plan-e4fa5cb.md`
    for the pane_layout.py split strategy.


    Tests: Run `pytest tests/` — existing pane_layout tests (test_pane_layout.py,
    test_session_registry.py) pass. Note: test_pane_layout.py now has substantial
    registry tests from the multi-window refactor. Verify those still pass with the
    new import paths. Add tests for: (1) register_pane creates per-window registry
    entries, (2) unregister_pane removes entries across windows, (3) find_live_pane_by_role
    with and without window scoping, (4) load_registry old-format migration, (5) load_registry
    handles missing file gracefully, (6) _get_window_data creates entries on demand,
    (7) _iter_all_panes yields from all windows, (8) kill_and_unregister combines
    kill+cleanup. Add these to test_session_registry.py or create tests/test_pane_registry.py.


    Files: pm_core/pane_layout.py (modify — remove registry functions, ~340 lines
    remaining), pm_core/pane_registry.py (create — ~280 lines)'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/59
  gh_pr_number: 59
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-7671dc7-extract-pane-registry-i-o-from-pane--b41f9a32
- id: pr-6ccf2a8
  plan: plan-e4fa5cb
  title: Deduplicate _extract_field and consolidate git root helpers
  branch: pm/pr-6ccf2a8-deduplicate-extract-field-and-consolidate-git-root
  status: merged
  depends_on: []
  description: '(1) Remove the duplicate _extract_field from tui/detail_panel.py (line
    43) and import it from plan_parser.py (line 79) instead — both implementations
    are identical. (2) Move _find_git_root from paths.py (line 68) and wrapper.py
    (line 17) into git_ops.py as a single get_git_root function. (3) Move the duplicate
    GitHub repo name extraction from paths.py (line 87) and wrapper.py (line 31) into
    git_ops.py. Update all callers. See `pm/plans/plan-e4fa5cb.md` for the deduplication
    strategy.


    Tests: Run `pytest tests/` — all existing tests pass. The moved functions currently
    have zero direct unit tests, so add verification tests: (1) test that _extract_field
    can be imported from plan_parser and returns correct results for typical PR description
    fields, (2) test git_ops.get_git_root finds .git dir, handles missing, traverses
    parent dirs, (3) test git_ops.get_github_repo_name with HTTPS URLs, SSH URLs,
    and edge cases, (4) test that detail_panel.py, paths.py, and wrapper.py all successfully
    import the shared versions (import smoke tests to catch broken references). Add
    these to existing test files (test_plan_parser.py, test_git_remote_detection.py)
    or create test_dedup.py.


    Files: pm_core/tui/detail_panel.py (modify — remove _extract_field, add import),
    pm_core/plan_parser.py (modify — make _extract_field public or importable), pm_core/git_ops.py
    (modify — add get_git_root and get_github_repo_name), pm_core/wrapper.py (modify
    — remove duplicates, import from git_ops), pm_core/paths.py (modify — remove duplicates,
    import from git_ops)'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/58
  gh_pr_number: 58
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-6ccf2a8-deduplicate-extract-field-and-consol-b41f9a32
- id: pr-ac3625d
  plan: plan-e4fa5cb
  title: Add Claude-based TUI tests for detail panel, filters, sync, meta, and log
    viewer
  branch: pm/pr-ac3625d-add-claude-based-tui-tests-for-detail-panel-filter
  status: merged
  depends_on: []
  description: 'Add five new Claude-based TUI test prompts to tui_tests.py (which
    currently has 13 tests including the recently added multi-window-registry and
    window-resize tests) following the existing format (Background, Available Tools,
    Test Procedure, Expected Behavior, Reporting sections): (1) Detail Panel Content
    Test — verify the detail panel shows correct PR info (title, status, branch, deps,
    plan context) and updates when navigating between PRs, (2) Status Filter & Merged
    Toggle Test — test F key cycles through status filters (all → pending → in_progress
    → done) and X key toggles merged PR visibility, verify tech tree updates accordingly,
    (3) Sync Refresh Test — test r key triggers sync, verify log line updates and
    PR statuses change if PRs were merged upstream, (4) Meta Session Launch Test —
    test m key launches a meta pane, verify pane registry and correct role, (5) TUI
    Log Viewer Test — test L key opens log pane, verify content and pane lifecycle.
    Register all five in the ALL_TESTS dict at the bottom of the file, bringing the
    total to 18 tests. The multi-window registry format is now the standard — new
    test fixtures should use the `{"windows": {...}}` format, not the old flat `{"panes":
    [...]}` format. See `pm/plans/plan-e4fa5cb.md` for test descriptions.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/60
  gh_pr_number: 60
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-ac3625d-add-claude-based-tui-tests-for-detai-b41f9a32
- id: pr-40bb8c2
  plan: plan-e4fa5cb
  title: Add unit tests for low-coverage modules
  branch: pm/pr-40bb8c2-add-unit-tests-for-low-coverage-modules
  status: merged
  depends_on:
  - pr-6ccf2a8
  description: 'Add comprehensive unit tests for the seven lowest-coverage modules
    to raise each above 50%. Pure logic modules (no mocking needed): graph.py (currently
    19%) — test build_adjacency with empty/linear/diamond graphs, topological_sort
    ordering, ready_prs/blocked_prs with various dependency states, compute_layers
    layering. review.py (currently 14%) — test build_fix_prompt output format, review_step
    with mocked subprocess, parse_review_file parsing. notes.py (currently 48%) —
    test notes file resolution with/without pm dir, splash text generation. Modules
    requiring mocked subprocess: git_ops.py (currently 47%) — test run_git (success,
    failure, timeout), branch name parsing, remote URL extraction, and the new get_git_root/get_github_repo_name
    from the dedup PR. detail_panel.py (currently 15%) — test plan section extraction
    using _extract_field (now imported from plan_parser after the dedup PR lands)
    and PR display formatting. tmux.py (currently 32%) — test session/window/pane
    helper functions with mocked subprocess (session_exists, create_session, new_window,
    split_pane, get_pane_geometries, current_or_base_session). claude_launcher.py
    (currently 34%) — test build_claude_shell_cmd output, find_claude/find_editor
    with mocked shutil.which, load_session/save_session/clear_session round-trip with
    tmp files. This depends on the dedup PR so that detail_panel and git_ops tests
    target the post-dedup code. See pm/plans/plan-e4fa5cb.md for coverage targets.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/64
  gh_pr_number: 64
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-40bb8c2-add-unit-tests-for-low-coverage-modu-e742c9f2
- id: pr-0febd7c
  title: Configurable keybindings
  branch: pm/pr-0febd7c-configurable-keybindings
  status: pending
  depends_on: []
  description: 'Add configurable TUI keybindings support:

    - New pm_core/keymap.py module with default keymap and emacs preset

    - pm keymap init [--preset emacs] [--force] CLI command to generate ~/.pm/keymap.yaml

    - pm keymap show and pm keymap reset commands

    - Refactor all 4 widget on_key handlers (TechTree, PlansPane, TestsPane, PlanPickerScreen)
    from hardcoded keys to action-based dispatch via set_keymap()

    - Dynamic HelpScreen that reflects the active keymap config

    - Dynamic app-level BINDINGS built from keymap at startup

    - Fallback to hardcoded defaults when no config file exists'
  agent_machine: null
  gh_pr: null
  gh_pr_number: null
  plan: plan-003
- id: pr-3563708
  plan: plan-e4fa5cb
  title: Extract PR view, sync, and frame capture from app.py
  branch: pm/pr-3563708-extract-pr-view-sync-and-frame-capture-from-app-py
  status: merged
  depends_on:
  - pr-f24211b
  description: 'Reduce tui/app.py from 1,323 lines to ~550 by extracting three concerns
    into new modules, following the existing pane_ops.py pattern (functions taking
    app as first parameter). (1) tui/frame_capture.py (~120 lines) — move frame capture
    infrastructure: DEFAULT_FRAME_RATE, DEFAULT_FRAME_BUFFER_SIZE constants, get_capture_config_path,
    get_frames_path, load_capture_config, capture_frame, save_frames, setup_frame_watchers,
    and the three on_*_changed callbacks. App keeps a one-line forwarding _capture_frame
    method since it is called from ~15 sites. (2) tui/sync.py (~190 lines) — move
    background and startup sync: background_sync(app), do_normal_sync(app, is_manual),
    startup_github_sync(app). These call app.log_message(), app._update_display(),
    app._show_normal_view() etc. via the app param (no circular imports). (3) tui/pr_view.py
    (~310 lines) — move PR actions and command execution: PR message handlers (handle_pr_selected,
    handle_pr_activated), PR workflow (start_pr, done_pr), tree filtering (hide_plan,
    toggle_merged, cycle_filter), plan movement (move_to_plan, handle_plan_pick),
    command execution (handle_command_submitted, run_command, run_command_sync, run_command_async),
    and the action guard (guard_pr_action, PR_ACTION_PREFIXES). App keeps _run_command
    as a one-line forwarder since pane_ops.py calls app._run_command(). After extraction,
    app.py retains: CSS/BINDINGS (~140 lines), init/compose/lifecycle (~70 lines),
    state loading and view switching (~100 lines), log/status utilities (~60 lines),
    plans view handlers (~80 lines, too small to extract), tests view handlers (~45
    lines, too small to extract), and thin message handler stubs delegating to extracted
    modules (~40 lines). See pm/plans/plan-e4fa5cb.md for the tui/app.py split strategy.'
  agent_machine: spark-424d
  gh_pr: https://github.com/mjtomei/project_manager/pull/66
  gh_pr_number: 66
  workdir: /home/matt/.pm/workdirs/project-manager-828c8d0a/pm-pr-3563708-extract-pr-view-sync-and-frame-captu-9b46a99c
